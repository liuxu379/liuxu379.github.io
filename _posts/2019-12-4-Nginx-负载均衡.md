---
layout:     post
title:      Nginx é…ç½®è´Ÿè½½å‡è¡¡
subtitle:   
date:       2019-12-4
author:     liuxu379
header-img: img/post-bg-2015.jpg
catalog: true
tags:
 - Nginx
---




Nginx çš„è´Ÿè½½å‡è¡¡æœ‰**äº”ç§**ç­–ç•¥ï¼Œåˆ†åˆ«æ˜¯ï¼š

- **è½®è¯¢(é»˜è®¤)**

- **Weight**

- **ip_hash**

- **fair**

- **url_hash**

***

  

## **è½®è¯¢(é»˜è®¤)**

***

æ¯ä¸ªè¯·æ±‚æŒ‰é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œå¦‚æœæŸä¸ªæœåŠ¡å™¨å®•æœºï¼Œåˆ™ä¼šè‡ªåŠ¨å‰”é™¤ã€‚

```
upstream backserver {
  server 192.168.1.1;
  server 192.168.1.2;
}
```



## **Weight**

***

ä¸ªäººç†è§£çš„å°±æ˜¯æŒ‰ç…§ä¸€å®šæ¯”ä¾‹æ¥è¿›è¡Œåˆ†é…è¯·æ±‚ï¼Œå½“è´Ÿè½½å‡è¡¡æœåŠ¡å™¨çš„é…ç½®ä¸ç›¸åŒæ—¶ï¼Œå¯ä»¥é‡‡ç”¨æ­¤ç§æ–¹å¼ã€‚

```
upstream backserver {
  server 192.168.1.1 weight=3;
  server 192.168.1.2 weight=7;
}
```



## ip_hash

***

æ­¤ç§æ–¹å¼æ˜¯ä¸ºäº†è§£å†³ session é—®é¢˜ã€‚å½“ç”¨æˆ·ç™»å½•æ—¶ï¼Œè´Ÿè½½å‡è¡¡æŒ‡å‘çš„æ˜¯ A æœåŠ¡å™¨ï¼Œç”¨æˆ·ç¬¬äºŒæ¬¡è®¿é—®çš„æ—¶å€™æŒ‡å‘äº† B æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±æ‰¾ä¸åˆ°ç™»å½•ä¿¡æ¯äº†ã€‚æ‰€ä»¥é‡‡ç”¨ **ip_hash** è¿™ç§æ–¹å¼å¯ä»¥è§£å†³è¿™ç§é—®é¢˜ã€‚

**ip_hash** æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯**æ ¹æ® IP çš„ hash ç»“æœè¿›è¡Œåˆ†é…**ï¼Œè®©ç”¨æˆ·æŒç»­è®¿é—®åŒä¸€å°æœåŠ¡å™¨ã€‚

```
upstream backserver {
    ip_hash;
    server 192.168.1.1;
    server 192.168.1.2;
}
```



## fair

***

è¿™ä¸ªæ¨¡å¼æ˜¯æŒ‰åç«¯æœåŠ¡å™¨å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚

å½“æœåŠ¡å™¨ä¸åœ¨åŒä¸€åœ°åŒºæ—¶å¯ä»¥è¯•è¯•ã€‚

```
upstream backserver {
    server 192.168.1.1;
    server 192.168.1.2;
    fair;
}
```



## url_hash

***

æŒ‰è®¿é—®çš„ url çš„ hash ç»“æœæ¥åˆ†é…è¯·æ±‚ã€‚å…·ä½“çš„æ²¡äº†è§£ï¼Œå°±å…ˆä¸å†™äº†ï¼Œå˜»å˜»ğŸ¤­